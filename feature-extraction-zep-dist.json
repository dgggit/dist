{"paragraphs":[{"text":"%md\n\n# Feature Extration (using KDD '15 Dataset)\n\nv16\n","user":"jhko","dateUpdated":"2020-05-14T18:42:50+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402488_2142107786","id":"20200514-174043_1224219972","dateCreated":"2020-05-14T18:36:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:101763","dateFinished":"2020-05-14T18:42:50+0000","dateStarted":"2020-05-14T18:42:50+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Feature Extration (using KDD &rsquo;15 Dataset)</h1>\n<p>v16</p>\n</div>"}]}},{"text":"%pyspark\n\nfrom os.path import abspath\n\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import Row\nfrom pyspark.ml.feature import VectorAssembler\n\nimport datetime\n\n### Zeppelin automatically binds spark variables to its interpreter.\n### Thus no need to run the following line.\n\n#spark = SparkSession.builder.getOrCreate()","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402489_-1564462370","id":"20200512-073114_1549596553","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101764"},{"text":"%pyspark\ndef log2row(line):    \n    fields = line.split(',')\n    row_eid = int(fields[0])\n    row_source = fields[2]\n    row_event = fields[3]\n    row_object = fields[4]\n    t = fields[1].split('T')\n    r_date = t[0].split('-')\n    r_time = t[1].split(':')\n    row_date = datetime.datetime(int(r_date[0]), int(r_date[1]), int(r_date[2]), 0, 0, 0)\n    row_time = datetime.datetime(1990, 1, 1, int(r_time[0]), int(r_time[1]), int(r_time[2]))\n    return Row(enrollment_id = row_eid, date = row_date, time = row_time, source = row_source, event = row_event, object_id = row_object )\n\n\ndef true2row(line):\n    fields = line.split(',')\n    row_eid = int(fields[0])\n    row_dropout = bool(int(fields[1]))\n    return Row(enrollment_id = row_eid, dropout = row_dropout)\n        \n\ndef date2row(line):\n    fields = line.split(',')\n    row_cid = fields[0]\n    r_from = fields[1].split('-')\n    r_to = fields[2].split('-')\n    row_from = datetime.datetime(int(r_from[0]), int(r_from[1]), int(r_from[2]), 0, 0, 0)\n    row_to = datetime.datetime(int(r_to[0]), int(r_to[1]), int(r_to[2]), 0, 0, 0)    \n    return Row(course_id = row_cid, fromdate = row_from, todate = row_to) \n\ndef enrollment2row(line):\n    fields = line.split(',')\n    row_eid = int(fields[0])\n    row_username = fields[1]\n    row_cid = fields[2]\n    return Row(enrollment_id = row_eid, username = row_username, course_id = row_cid)\n  \n    \ndef object2row(line):\n    fields = line.split(',')\n    if len(fields) == 5:    \n        row_cid = fields[0]\n        row_mid = fields[1]\n        row_category = fields[2]\n        row_children = fields[3]\n        row_date = datetime.datetime(1990, 1, 1, 0, 0, 0)\n        row_time = datetime.datetime(1990, 1, 1, 0, 0, 0)\n        if fields[4] != \"null\":\n            t = fields[4].split('T')\n            r_date = t[0].split('-')\n            r_time = t[1].split(':')\n            row_date = datetime.datetime(int(r_date[0]), int(r_date[1]), int(r_date[2]), 0, 0, 0)\n            row_time = datetime.datetime(1990, 1, 1, int(r_time[0]), int(r_time[1]), int(r_time[2]))\n        return Row(course_id = row_cid, module_id = row_mid, category = row_category, children=row_children, date=row_date, time=row_time)\n    elif len(fields) == 4:\n        row_cid = fields[0]\n        row_mid = fields[1]\n        row_category = fields[2]\n        row_children = \"\"        \n        row_date = datetime.datetime(1990, 1, 1, 0, 0, 0)\n        row_time = datetime.datetime(1990, 1, 1, 0, 0, 0)\n        if fields[3] != \"null\":\n            t = fields[3].split('T')\n            r_date = t[0].split('-')\n            r_time = t[1].split(':')\n            row_date = datetime.datetime(int(r_date[0]), int(r_date[1]), int(r_date[2]), 0, 0, 0)\n            row_time = datetime.datetime(1990, 1, 1, int(r_time[0]), int(r_time[1]), int(r_time[2]))\n        return Row(course_id = row_cid, module_id = row_mid, category = row_category, children=row_children, date=row_date, time=row_time)    \n\n","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402490_-1762280221","id":"20200512-073147_1218452920","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101765"},{"text":"%pyspark\n#Convert each csv file to RDD\n#Parse each line using function defined above\n#Convert parsed RDD to DataFrame and create temp views\n\n\n###########################################################\n############ TODO change it to your directory #############\nDATAPATH = \"file:///home/jhko/test/featuredata\"\n###########################################################\n\n\nlog_table = spark.sparkContext.textFile(\"{}/log_10percent.csv\".format(DATAPATH)) # use truncated dataset (10%).\nlog_head = log_table.first()\nlog_table_no_header = log_table.filter(lambda x : x != log_head)\n\n\ntrue_table = spark.sparkContext.textFile(\"{}/truth_train.csv\".format(DATAPATH))\ntrue_head = true_table.first()\ntrue_table_no_header = true_table.filter(lambda x : x != true_head)\n\n\ndate_table = spark.sparkContext.textFile(\"{}/date.csv\".format(DATAPATH))\ndate_head = date_table.first()\ndate_table_no_header = date_table.filter(lambda x : x != date_head)\n\n\nenrollment_table = spark.sparkContext.textFile(\"{}/enrollment.csv\".format(DATAPATH))\nenrollment_head = enrollment_table.first()\nenrollment_table_no_header = enrollment_table.filter(lambda x : x != enrollment_head)\n\nobject_table = spark.sparkContext.textFile(\"{}/object.csv\".format(DATAPATH))\nobject_head = object_table.first()\nobject_table_no_header = object_table.filter(lambda x : x != object_head)","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402490_2131166240","id":"20200514-010200_323460860","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101766"},{"text":"%pyspark\nlog_rows = log_table_no_header.map(log2row)\ntrue_rows = true_table_no_header.map(true2row)\ndate_rows = date_table_no_header.map(date2row)\nenrollment_rows = enrollment_table_no_header.map(enrollment2row)\nobject_rows = object_table_no_header.map(object2row)","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402490_57255667","id":"20200514-010218_542764638","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101767"},{"text":"%pyspark\n\n# WRITE YOUR CODE HERE\n\n# log_df = ~~\n# log_df.~~\n\n","user":"jhko","dateUpdated":"2020-05-14T18:37:53+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402491_469035202","id":"20200514-010412_1835570250","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101768"},{"text":"%pyspark\nlog_df.show(3)\nlog_df.printSchema()\ntrue_df.show(3)\ndate_df.show(3)\nenrollment_df.show(3)\nobject_df.show(3)","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402491_65489752","id":"20200514-010229_1134368327","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101769"},{"text":"%sql\n\nSQL 1","user":"jhko","dateUpdated":"2020-05-14T18:39:49+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"enrollment_id":"string","c_discusion":"string","c_wiki":"string","c_page_close":"string","c_access":"string","c_video":"string","c_navigate":"string","c_problem":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402491_1700252472","id":"20200514-155702_126253252","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101770"},{"text":"%pyspark\n# SQL 1\n# COUNT: 7\nresults1 = spark.sql('''SQL 1''').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:39:53+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"enrollment_id":"string","c_discusion":"string","c_wiki":"string","c_page_close":"string","c_access":"string","c_video":"string","c_navigate":"string","c_problem":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"enrollment_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"c_discusion","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402491_408683718","id":"20200512-163357_1796708995","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101771"},{"text":"%sql\n\nSQL 2","user":"jhko","dateUpdated":"2020-05-14T18:39:57+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"enrollment_id":"string","s_browser":"string","s_server":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"enrollment_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"s_browser","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402492_-912138890","id":"20200514-155621_914710147","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101772"},{"text":"%pyspark\n# SQL 2\n# COUNT: 2, ACCUMULATE: 9\nresults2 = spark.sql('''SQL 2''').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:40:03+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"enrollment_id":"string","s_browser":"string","s_server":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"enrollment_id":"string","s_browser":"string","s_server":"string","c_discusion":"string","c_wiki":"string","c_page_close":"string","c_access":"string","c_video":"string","c_navigate":"string","c_problem":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"enrollment_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"s_browser","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402492_-1593002139","id":"20200512-163411_1382899349","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101773"},{"text":"%pyspark\n# Join SQL 2 with 1\njoined_results1_2 = results2.join(results1,'enrollment_id','outer').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"enrollment_id":"string","s_browser":"string","s_server":"string","c_discusion":"string","c_wiki":"string","c_page_close":"string","c_access":"string","c_video":"string","c_navigate":"string","c_problem":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402492_1905460565","id":"20200514-013716_1318894542","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101774"},{"text":"%sql\n\nSQL 3","user":"jhko","dateUpdated":"2020-05-14T18:40:07+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"course_id":"string","count_eid_per_course":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402493_-1056383509","id":"20200514-155817_1790718033","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101775"},{"text":"%pyspark\n# SQL 3\n# COUNT: 1, ACCUMULATE: 10\nresults3 = spark.sql('SQL 3').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:40:12+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"course_id":"string","count_eid_per_course":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402493_-764178632","id":"20200514-013510_2123324132","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101776"},{"text":"%sql\n\nSQL 4","user":"jhko","dateUpdated":"2020-05-14T18:40:17+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"course_id":"string","dropout_per_course":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402493_821241188","id":"20200514-155834_1377700075","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101777"},{"text":"%pyspark\n# SQL 4\n# COUNT: 1, ACCUMULATE: 11\nresults4 = spark.sql('SQL 4').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:40:22+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"course_id":"string","dropout_per_course":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402494_-537630652","id":"20200514-013518_1618802392","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101778"},{"text":"%sql\n\nSQL 5","user":"jhko","dateUpdated":"2020-05-14T18:40:27+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"course_id":"string","dropoutrate_per_course":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402494_-2011622321","id":"20200514-155855_1656220623","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101779"},{"text":"%pyspark\n# SQL 5\n# COUNT: 1, ACCUMULATE: 12\nresults5 = spark.sql('SQL 5').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:40:34+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"course_id":"string","dropoutrate_per_course":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402494_1264338875","id":"20200514-013525_92229022","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101780"},{"text":"%pyspark\n# Join SQL 3,4,5 with 1~2\njoined_result_3_4_5 = results3.join(results4,'course_id','outer').join(results5,'course_id','outer').cache()\njoined_result_3_4_5_edf = joined_result_3_4_5.join(enrollment_df, 'course_id','outer').cache()\njoined_result1_2_3_4_5_edf = joined_result_3_4_5_edf.join(joined_results1_2, 'enrollment_id','outer').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402494_-737401919","id":"20200514-013531_973716001","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101781"},{"text":"%sql\nSQL 6","user":"jhko","dateUpdated":"2020-05-14T18:40:39+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"username":"string","count_eid_per_user":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402495_621101156","id":"20200514-155921_1627692107","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101782"},{"text":"%pyspark\n#SQL 6\n# COUNT: 1, ACCUMULATE: 13\nresults6 = spark.sql('SQL 6').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:40:44+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"username":"string","count_eid_per_user":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402495_2061809156","id":"20200514-013312_962341574","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101783"},{"text":"%sql\n\nSQL 7","user":"jhko","dateUpdated":"2020-05-14T18:40:52+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"username":"string","dropout_per_user":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402495_1785382871","id":"20200514-155953_392586450","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101784"},{"text":"%pyspark\n#SQL 7\n# COUNT: 1, ACCUMULATE: 14\nresults7 = spark.sql('SQL 7').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:40:59+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"username":"string","dropout_per_user":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402495_-1727076689","id":"20200514-013315_1538109094","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101785"},{"text":"%sql\n\nSQL 8","user":"jhko","dateUpdated":"2020-05-14T18:41:09+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"scatterChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{"columns":[{"name":"username","visible":true,"width":"*","sort":{"priority":0,"direction":"asc"},"filters":[{}],"pinned":""},{"name":"dropoutrate_per_user","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"username":"string","dropoutrate_per_user":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"hide"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{}},"commonSetting":{},"keys":[{"name":"dropoutrate_per_user","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"username","index":0,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402496_553369575","id":"20200514-160007_149763246","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101786"},{"text":"%pyspark\n# SQL 8\n# COUNT: 1, ACCUMULATE: 15\nresults8 = spark.sql('SQL 8').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:41:15+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"username":"string","dropoutrate_per_user":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402496_-1878529416","id":"20200514-013317_236545291","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101787"},{"text":"%pyspark\n# Join SQL 6,7,8 with 1~5\njoined_result_6_7_8 = results6.join(results7,'username','outer').join(results8, 'username','outer').cache()\njoined_result1_2_3_4_5_6_7_8_edf = joined_result_6_7_8.join(joined_result1_2_3_4_5_edf, 'username','outer').drop('username').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402496_905752916","id":"20200514-013342_1894327687","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101788"},{"text":"%sql\n\nSQL 9","user":"jhko","dateUpdated":"2020-05-14T18:41:22+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"enrollment_id":"string","period":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"enrollment_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"period","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402497_-2137742983","id":"20200514-160029_227244120","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101789"},{"text":"%pyspark\n#SQL 9 \n# COUNT: 1, ACCUMULATE: 16\nresults9 = spark.sql('SQL 9').cache()\n\n","user":"jhko","dateUpdated":"2020-05-14T18:41:31+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"enrollment_id":"string","period":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"enrollment_id","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"period","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402497_-113243946","id":"20200514-012425_1119934346","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101790"},{"text":"%pyspark\n# Join SQL 9 with 1~8\njoined_result1_2_3_4_5_6_7_8_9_edf = results9.join(joined_result1_2_3_4_5_6_7_8_edf, 'enrollment_id','outer')","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402497_-833639210","id":"20200514-013136_1630830120","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101791"},{"text":"%sql\n\nSQL 10","user":"jhko","dateUpdated":"2020-05-14T18:41:49+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"enrollment_id":"string","effective_study_days":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402498_1513647809","id":"20200514-160041_1016980967","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101792"},{"text":"%pyspark\n# SQL 10\n# COUNT: 1, ACCUMULATE: 17\nresults10 = spark.sql('SQL 10').cache()\n","user":"jhko","dateUpdated":"2020-05-14T18:41:56+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"enrollment_id":"string","effective_study_days":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402498_-376052052","id":"20200514-012452_1241508256","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101793"},{"text":"%pyspark\n# Join SQL 10 with 1~9\njoined_result1_2_3_4_5_6_7_8_9_10_edf = results10.join(joined_result1_2_3_4_5_6_7_8_9_edf, 'enrollment_id','outer').cache()\njoined_result1_2_3_4_5_6_7_8_9_10_edf.printSchema()\n","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402498_1160645668","id":"20200514-013144_1260994404","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101794"},{"text":"%pyspark\nz.show(joined_result1_2_3_4_5_6_7_8_9_10_edf)","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"enrollment_id":"string","effective_study_days":"string","period":"string","count_eid_per_user":"string","dropout_per_user":"string","dropoutrate_per_user":"string","course_id":"string","count_eid_per_course":"string","dropout_per_course":"string","dropoutrate_per_course":"string","s_browser":"string","s_server":"string","c_discusion":"string","c_wiki":"string","c_page_close":"string","c_access":"string","c_video":"string","c_navigate":"string","c_problem":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402499_-47350330","id":"20200514-181403_923617694","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101795"},{"text":"%pyspark\n\n# Generate vector column of all features\n\njoined_result_total = joined_result1_2_3_4_5_6_7_8_9_10_edf.drop('course_id')\njoined_result_total_numeric = joined_result_total.na.fill(0)\n\ncolumns_list = joined_result_total_numeric.columns\ncolumns_list.remove('enrollment_id')\n\nassembler = VectorAssembler(inputCols=columns_list, outputCol=\"feature\")\nassemble_result = assembler.transform(joined_result_total_numeric).cache() # combine columns except enrollment_id\n\nfor column in columns_list:# remove all columns except enrollmnet_id and 'feature'\n    assemble_result = assemble_result.drop(column).cache()\n    \nfinal_result = assemble_result.cache() # sorted by enrollment_id. This is a final result.\n\nz.show(final_result)","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402499_136489059","id":"20200514-012622_802008978","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101796"},{"text":"%pyspark\njoined_result_total_numeric.printSchema()","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402499_-1272376420","id":"20200514-012649_1683445399","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101797"},{"text":"%pyspark\n##########  Split train_dataset and test_dataset  ##########\n# final_result: feature_train + feature_test\n#     Schema - 'enrollment_id', 'feature'\n# true_df: only train enrollment_id exist\n#     Schema - 'enrollment_id', 'dropout'\n\n\n#Left Outer Join final_result and true_df\n#     train enrollment_id will have 'dropout' attribute 'True' or 'False'\n#     test enrollment_id will have 'dropout' attribute 'NULL'\nagg_result = final_result.join(true_df, 'enrollment_id', how='left_outer').cache()\n\n# Split\ntrain_dataset_df = agg_result.filter('dropout is  not null').sort('enrollment_id').cache()\ntest_dataset_df = agg_result.filter('dropout is null').sort('enrollment_id').cache()\n\n\n### Collect your data!\n\n### df.select(column_name) : return df with only that column\n### df.collect() : return matrix of df\ntrain_dataset = train_dataset_df.select('feature', 'dropout', 'enrollment_id').collect()\ntest_dataset = test_dataset_df.select('feature', 'enrollment_id').collect()\n\n\n","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402500_1009559475","id":"20200512-073555_1214315743","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101798"},{"text":"%pyspark\n\ntrain_feature = [list(l[0]) for l in train_dataset]\ntrain_label = [float(l[1]) for l in train_dataset]\ntest_feature = [list(l[0]) for l in test_dataset]\n\ntrain_eid = [int(l[2]) for l in train_dataset]\ntest_eid = [int(l[1]) for l in test_dataset]\n\nprint(train_feature[:3])\nprint(train_label[:3])\nprint(test_feature[:3])\n\nprint(train_eid[:3])\nprint(test_eid[:3])","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402500_1844708316","id":"20200514-014318_880139210","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101799"},{"text":"%pyspark\n\n###########################################################\n############ TODO change it to your directory #############\nOUTPUTPATH = \"/home/jhko/test/featuredata\"\n###########################################################\n\nimport csv\n\nwith open('{}/train_feature.csv'.format(OUTPUTPATH), 'w', newline='') as f:\n    wr = csv.writer(f)\n    for line in train_feature:\n        wr.writerow(line)\n    f.close()\n    \nwith open('{}/train_label.csv'.format(OUTPUTPATH), 'w', newline='') as f:\n    wr = csv.writer(f)\n    for line in train_label:\n        wr.writerow([line])\n    f.close()\n    \nwith open('{}/test_feature.csv'.format(OUTPUTPATH), 'w', newline='') as f:\n    wr = csv.writer(f)\n    for line in test_feature:\n        wr.writerow(line)\n    f.close()\n    \nwith open('{}/train_eid.csv'.format(OUTPUTPATH), 'w', newline='') as f:\n    wr = csv.writer(f)\n    for line in train_eid:\n        wr.writerow([line])\n    f.close()\n    \nwith open('{}/test_eid.csv'.format(OUTPUTPATH), 'w', newline='') as f:\n    wr = csv.writer(f)\n    for line in test_eid:\n        wr.writerow([line])\n    f.close()\n    ","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402500_801865043","id":"20200514-022214_889476763","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101800"},{"text":"%pyspark\n","user":"jhko","dateUpdated":"2020-05-14T18:36:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589481402500_-1635455368","id":"20200514-183116_110538416","dateCreated":"2020-05-14T18:36:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101801"}],"name":"feature-extraction-zep-dist","id":"2F8URBSGF","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}