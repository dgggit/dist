{"paragraphs":[{"text":"%md\n\n# Advanced SQL Query with SparkSQL\n### with Churn Prediction dataset\n\n* Window function queries : https://15445.courses.cs.cmu.edu/fall2019/slides/02-advancedsql.pdf (~p33)\n* Window funcion with PySpark : https://sparkbyexamples.com/spark/spark-sql-window-functions/\n* Window function in time series data : https://blog.jooq.org/2015/05/12/use-this-neat-window-function-trick-to-calculate-time-differences-in-a-time-series/","user":"jhko","dateUpdated":"2020-07-23T15:36:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Advanced SQL Query with SparkSQL</h1>\n<h3>with Churn Prediction dataset</h3>\n<ul>\n  <li>Window function queries : <a href=\"https://15445.courses.cs.cmu.edu/fall2019/slides/02-advancedsql.pdf\">https://15445.courses.cs.cmu.edu/fall2019/slides/02-advancedsql.pdf</a> (~p33)</li>\n  <li>Window funcion with PySpark : <a href=\"https://sparkbyexamples.com/spark/spark-sql-window-functions/\">https://sparkbyexamples.com/spark/spark-sql-window-functions/</a></li>\n  <li>Window function in time series data : <a href=\"https://blog.jooq.org/2015/05/12/use-this-neat-window-function-trick-to-calculate-time-differences-in-a-time-series/\">https://blog.jooq.org/2015/05/12/use-this-neat-window-function-trick-to-calculate-time-differences-in-a-time-series/</a></li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1595509035169_1527754892","id":"20200723-125715_1989044095","dateCreated":"2020-07-23T12:57:15+0000","dateStarted":"2020-07-23T15:36:15+0000","dateFinished":"2020-07-23T15:36:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3006"},{"text":"%pyspark\n\nfrom os.path import abspath\n\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import Row\nfrom pyspark.ml.feature import VectorAssembler\n\nimport datetime","user":"jhko","dateUpdated":"2020-07-23T12:59:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1595508923548_367148496","id":"20200723-125523_825659794","dateCreated":"2020-07-23T12:55:23+0000","dateStarted":"2020-07-23T12:59:40+0000","dateFinished":"2020-07-23T12:59:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3007"},{"text":"%pyspark\n\nDATAPATH = \"file:///input/project\"\n\nuser_data = spark.read.csv(\"{}/users_train_dist.csv\".format(DATAPATH), header=\"true\") # here we use train data\npost_data = spark.read.csv(\"{}/posts_dist.csv\".format(DATAPATH), header = \"true\")\n\nuser_data.createOrReplaceTempView('Users')\npost_data.createOrReplaceTempView('Posts')\n\nuser_data.printSchema()\npost_data.printSchema()","user":"jhko","dateUpdated":"2020-07-23T13:07:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Id: string (nullable = true)\n |-- CreationDate: string (nullable = true)\n |-- isChurn: string (nullable = true)\n\nroot\n |-- PostId: string (nullable = true)\n |-- PostTypeId: string (nullable = true)\n |-- AcceptedAnswerId: string (nullable = true)\n |-- CreationDate: string (nullable = true)\n |-- Score: string (nullable = true)\n |-- OwnerUserId: string (nullable = true)\n |-- AnswerCount: string (nullable = true)\n |-- CommentCount: string (nullable = true)\n |-- ParentId: string (nullable = true)\n |-- CreationDateOfOwner: string (nullable = true)\n |-- BodyWordNum: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1595509031394_607471390","id":"20200723-125711_1332074409","dateCreated":"2020-07-23T12:57:11+0000","dateStarted":"2020-07-23T13:07:12+0000","dateFinished":"2020-07-23T13:07:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3008"},{"text":"%md\n\n## 1. per user, get (average(score), PostTypeId) for each post type\n\nThe following two queries are equivalent!","user":"jhko","dateUpdated":"2020-07-23T14:25:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>1. per user, get (average(score), PostTypeId) for each post type</h2>\n<p>The following two queries are equivalent!</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1595509285877_388338697","id":"20200723-130125_1705347985","dateCreated":"2020-07-23T13:01:25+0000","dateStarted":"2020-07-23T14:25:24+0000","dateFinished":"2020-07-23T14:25:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3009"},{"text":"%sql\n--- using GROUP BY query\n\nSELECT OwnerUserId, PostTypeId, AVG(Score) avgScore\nFROM Posts\nGROUP BY OwnerUserId, PostTypeId\nORDER BY OwnerUserId\nLIMIT 10","user":"jhko","dateUpdated":"2020-07-24T00:02:16+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"OwnerUserId":"string","PostTypeId":"string","avgScore":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"OwnerUserId","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"question","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"OwnerUserId\tPostTypeId\tavgScore\n1\t2\t29.504347826086956\n1\t1\t357.8\n100\t2\t10.153846153846153\n100\t1\t31.076923076923077\n1000\t2\t6.626666666666667\n1000\t1\t9.636363636363637\n1000000\t1\t4.75\n1000000\t2\t3.142857142857143\n1000008\t2\t1.3333333333333333\n1000010\t1\t3.0\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1595511457447_817131131","id":"20200723-133737_1657800364","dateCreated":"2020-07-23T13:37:37+0000","dateStarted":"2020-07-23T14:24:02+0000","dateFinished":"2020-07-23T14:24:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3010"},{"text":"%sql\n--- using AVG()OVER() query\n\nSELECT DISTINCT\n       OwnerUserId, PostTypeId,\n       AVG(score)OVER(PARTITION BY PostTypeId, OwnerUserId) AverageScore\nFROM Posts\nORDER BY OwnerUserId\nLIMIT 10","user":"jhko","dateUpdated":"2020-07-23T14:24:54+0000","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"OwnerUserId":"string","PostTypeId":"string","AverageScore":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"OwnerUserId\tPostTypeId\tAverageScore\n1\t2\t29.504347826086956\n1\t1\t357.8\n100\t2\t10.153846153846153\n100\t1\t31.076923076923077\n1000\t2\t6.626666666666667\n1000\t1\t9.636363636363637\n1000000\t2\t3.142857142857143\n1000000\t1\t4.75\n1000008\t2\t1.3333333333333333\n1000010\t1\t3.0\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1595512102117_1692839470","id":"20200723-134822_327130187","dateCreated":"2020-07-23T13:48:22+0000","dateStarted":"2020-07-23T14:24:22+0000","dateFinished":"2020-07-23T14:24:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3011"},{"text":"%md\n\nHowever, `GROUP BY` only displays aggregated values of the group.  \nIt cannot show relevance between tuples within the same group. (e.g. rank, row number, gap between ordered tuples)\n\n","user":"jhko","dateUpdated":"2020-07-23T14:30:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>However, <code>GROUP BY</code> only displays aggregated values of the group.<br/>It cannot show relevance between tuples within the same group. (e.g. rank, row number, gap between ordered tuples)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1595513745599_172145079","id":"20200723-141545_1893330817","dateCreated":"2020-07-23T14:15:45+0000","dateStarted":"2020-07-23T14:30:50+0000","dateFinished":"2020-07-23T14:30:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3012"},{"text":"%md\n## 2. show me rank(average score) of each user","user":"jhko","dateUpdated":"2020-07-23T15:02:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>2. show me rank(average score) of each user</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1595514599962_1145948184","id":"20200723-142959_2123126698","dateCreated":"2020-07-23T14:29:59+0000","dateStarted":"2020-07-23T15:02:57+0000","dateFinished":"2020-07-23T15:02:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3013"},{"text":"%sql\n\n--- using RANK()OVER() query\n\nSELECT U.Id, S.avgScore,\n       RANK()OVER(ORDER BY S.avgScore DESC) postRank\nFROM Users U\n     LEFT OUTER JOIN\n     (SELECT OwnerUserId, AVG(score) avgScore FROM Posts GROUP BY OwnerUserId) S\n     ON U.Id = S.OwnerUserId\nORDER BY postRank\nLIMIT 20","user":"jhko","dateUpdated":"2020-07-23T15:36:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"OwnerUserId","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"PostTypeId","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"postRank","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Id":"string","avgScore":"string","postRank":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Id\tavgScore\tpostRank\n13161\t7737.0\t1\n581625\t3650.0\t2\n188383\t3326.0\t3\n210931\t3139.0\t4\n1074018\t2519.0\t5\n268413\t2465.0\t6\n595319\t2430.0\t7\n1040319\t2120.0\t8\n395371\t2029.0\t9\n901373\t2022.0\t10\n863084\t1913.0\t11\n883147\t1604.0\t12\n774578\t1594.0\t13\n4315\t1543.0\t14\n296561\t1526.3333333333333\t15\n664861\t1381.0\t16\n28409\t1326.5\t17\n760609\t1231.0\t18\n907949\t1229.0\t19\n588034\t1127.0\t20\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1595514888676_-1713852714","id":"20200723-143448_1136336426","dateCreated":"2020-07-23T14:34:48+0000","dateStarted":"2020-07-23T15:36:29+0000","dateFinished":"2020-07-23T15:36:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3014"},{"text":"%md\n## 3. Per post, show me gap(its creationdate, previous post's creationdate)","user":"jhko","dateUpdated":"2020-07-23T15:14:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>3. Per post, show me gap(its creationdate, previous post&rsquo;s creationdate)</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1595516732998_-1415278803","id":"20200723-150532_7466606","dateCreated":"2020-07-23T15:05:32+0000","dateStarted":"2020-07-23T15:14:34+0000","dateFinished":"2020-07-23T15:14:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3015"},{"text":"%sql\n\n--- using LAG()OVER() query\n\nSELECT OwnerUserId, PostId, CreationDate, PrevCreationDate, COALESCE( DATEDIFF(CreationDate, PrevCreationDate), 0) AS Gap\nFROM\n    (SELECT  OwnerUserId, PostId, CreationDate, LAG(CreationDate, 1) OVER(PARTITION BY OwnerUserId ORDER BY CreationDate) AS PrevCreationDate\n    FROM Posts P\n    ORDER BY OwnerUserId ASC)\nLIMIT 100","user":"jhko","dateUpdated":"2020-07-24T00:47:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"OwnerUserId":"string","PostId":"string","CreationDate":"string","PrevCreationDate":"string","Gap":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"OwnerUserId\tPostId\tCreationDate\tPrevCreationDate\tGap\n1\t1093637\t2009-07-07 17:24:04.750\t2009-07-02 09:31:44.303\t5\n1\t604422\t2009-03-02 22:56:01.477\t2009-02-21 09:16:05.313\t9\n1\t1073412\t2009-07-02 09:31:44.303\t2009-06-25 01:51:38.217\t7\n1\t331677\t2008-12-01 18:04:51.580\t2008-12-01 04:56:38.300\t0\n1\t572670\t2009-02-21 09:16:05.313\t2009-02-15 22:03:31.663\t6\n1\t713414\t2009-04-03 10:35:03.187\t2009-04-01 08:04:24.710\t2\n1\t1041817\t2009-06-25 01:51:38.217\t2009-06-07 08:30:38.443\t18\n1\t234080\t2008-10-24 15:45:15.683\t2008-10-24 08:39:46.913\t0\n1\t330073\t2008-12-01 04:56:38.300\t2008-11-26 04:15:42.220\t5\n1\t391381\t2008-12-24 13:07:56.140\t2008-12-23 11:00:12.857\t1\n1\t551692\t2009-02-15 22:03:31.663\t2009-02-12 07:45:54.617\t3\n1\t652727\t2009-03-17 01:19:56.020\t2009-03-10 22:59:37.453\t7\n1\t704511\t2009-04-01 08:04:24.710\t2009-03-31 08:55:42.657\t1\n1\t819384\t2009-05-04 09:08:24.840\t2009-04-16 09:31:19.553\t18\n1\t961504\t2009-06-07 08:30:38.443\t2009-06-06 04:29:58.493\t1\n1\t206745\t2008-10-15 22:20:53.593\t2008-10-15 18:56:39.607\t0\n1\t232848\t2008-10-24 08:39:46.913\t2008-10-24 06:10:57.930\t0\n1\t267380\t2008-11-06 01:17:46.993\t2008-11-01 17:56:15.967\t5\n1\t319730\t2008-11-26 04:15:42.220\t2008-11-17 12:58:21.920\t9\n1\t342540\t2008-12-05 00:34:40.107\t2008-12-03 16:16:43.187\t2\n1\t388633\t2008-12-23 11:00:12.857\t2008-12-13 00:24:17.193\t10\n1\t399775\t2008-12-30 08:23:06.693\t2008-12-24 13:07:56.140\t6\n1\t540383\t2009-02-12 07:45:54.617\t2009-02-02 10:06:53.257\t10\n1\t629602\t2009-03-10 10:32:26.640\t2009-03-10 01:05:12.293\t0\n1\t632621\t2009-03-10 22:59:37.453\t2009-03-10 10:32:26.640\t0\n1\t665162\t2009-03-20 06:22:25.097\t2009-03-18 22:37:31.613\t2\n1\t700654\t2009-03-31 08:55:42.657\t2009-03-30 08:00:18.947\t1\n1\t191147\t2008-10-10 12:59:39.503\t2008-10-09 22:49:00.650\t1\n1\t755369\t2009-04-16 09:31:19.553\t2009-04-03 10:35:03.187\t13\n1\t189495\t2008-10-09 22:49:00.650\t2008-10-07 08:48:00.477\t2\n1\t958997\t2009-06-06 04:29:58.493\t2009-05-19 08:34:12.627\t18\n1\t9446\t2008-08-13 03:30:58.860\t2008-08-12 23:27:54.093\t1\n1\t205967\t2008-10-15 18:56:39.607\t2008-10-13 09:34:25.950\t2\n1\t207284\t2008-10-16 03:00:52.047\t2008-10-15 22:20:53.593\t1\n1\t232618\t2008-10-24 06:10:57.930\t2008-10-16 03:00:52.047\t8\n1\t250899\t2008-10-30 16:49:26.900\t2008-10-24 15:45:15.683\t6\n1\t255861\t2008-11-01 17:56:15.967\t2008-10-30 16:49:26.900\t2\n1\t287154\t2008-11-13 14:59:51.007\t2008-11-12 14:02:14.047\t1\n1\t295521\t2008-11-17 12:58:21.920\t2008-11-13 14:59:51.007\t4\n1\t32254\t2008-08-28 13:26:27.823\t2008-08-28 11:23:59.427\t0\n1\t337704\t2008-12-03 16:16:43.187\t2008-12-03 09:31:03.723\t0\n1\t360090\t2008-12-11 16:57:57.650\t2008-12-05 00:34:40.107\t6\n1\t364555\t2008-12-13 00:24:17.193\t2008-12-11 16:57:57.650\t2\n1\t32021\t2008-08-28 11:23:59.427\t2008-08-27 13:08:30.010\t1\n1\t25486\t2008-08-25 00:11:43.763\t2008-08-24 23:40:09.253\t1\n1\t424220\t2009-01-08 13:31:06.323\t2009-01-05 23:54:56.457\t3\n1\t502734\t2009-02-02 10:06:53.257\t2009-02-01 00:39:33.747\t1\n1\t135155\t2008-09-25 18:42:54.543\t2008-09-20 16:22:51.863\t5\n1\t628593\t2009-03-10 01:05:12.293\t2009-03-03 11:29:38.980\t7\n1\t50544\t2008-09-08 20:04:18.290\t2008-09-07 19:17:04.073\t1\n1\t54538\t2008-09-10 16:08:14.597\t2008-09-08 20:04:18.290\t2\n1\t108614\t2008-09-20 16:22:51.863\t2008-09-19 08:46:42.740\t1\n1\t660382\t2009-03-18 22:37:31.613\t2009-03-17 01:19:56.020\t1\n1\t100544\t2008-09-19 08:46:42.740\t2008-09-15 11:03:36.220\t4\n1\t696353\t2009-03-30 08:00:18.947\t2009-03-20 06:22:25.097\t10\n1\t136443\t2008-09-25 21:58:05.383\t2008-09-25 18:42:54.543\t0\n1\t170072\t2008-10-04 10:06:37.823\t2008-10-03 06:37:26.097\t1\n1\t155826\t2008-10-01 01:19:17.377\t2008-09-25 21:58:05.383\t6\n1\t165917\t2008-10-03 06:37:26.097\t2008-10-01 01:19:17.377\t2\n1\t177651\t2008-10-07 08:48:00.477\t2008-10-07 08:01:40.227\t0\n1\t177539\t2008-10-07 08:01:40.227\t2008-10-04 10:06:37.823\t3\n1\t847146\t2009-05-11 08:05:23.527\t2009-05-04 09:08:24.840\t7\n1\t881597\t2009-05-19 08:34:12.627\t2009-05-11 08:05:23.527\t8\n1\t9\t2008-07-31 23:40:59.743\tnull\t0\n1\t1074\t2008-08-04 08:04:41.737\t2008-08-04 04:31:02.557\t0\n1\t37817\t2008-09-01 12:03:30.520\t2008-08-28 13:26:27.823\t4\n1\t197107\t2008-10-13 09:34:25.950\t2008-10-12 08:38:43.303\t1\n1\t11\t2008-07-31 23:55:37.967\t2008-07-31 23:40:59.743\t0\n1\t1016\t2008-08-04 04:31:02.557\t2008-08-04 02:45:07.717\t0\n1\t986\t2008-08-04 02:45:07.717\t2008-07-31 23:56:41.303\t4\n1\t12\t2008-07-31 23:56:41.303\t2008-07-31 23:55:37.967\t0\n1\t8368\t2008-08-12 00:30:43.390\t2008-08-11 19:23:47.160\t1\n1\t9318\t2008-08-12 23:27:54.093\t2008-08-12 23:13:41.470\t0\n1\t8116\t2008-08-11 19:23:47.160\t2008-08-10 08:28:52.100\t1\n1\t7099\t2008-08-10 08:28:52.100\t2008-08-04 08:04:41.737\t6\n1\t9310\t2008-08-12 23:13:41.470\t2008-08-12 05:02:49.453\t0\n1\t284016\t2008-11-12 14:02:14.047\t2008-11-06 01:17:46.993\t6\n1\t8474\t2008-08-12 05:02:49.453\t2008-08-12 04:59:35.017\t0\n1\t8472\t2008-08-12 04:59:35.017\t2008-08-12 00:30:43.390\t0\n1\t10614\t2008-08-14 03:10:22.660\t2008-08-13 12:03:05.940\t1\n1\t13488\t2008-08-17 03:00:34.317\t2008-08-17 02:58:18.083\t0\n1\t9685\t2008-08-13 12:03:05.940\t2008-08-13 03:30:58.860\t0\n1\t336623\t2008-12-03 09:31:03.723\t2008-12-01 18:04:51.580\t2\n1\t10617\t2008-08-14 03:13:56.770\t2008-08-14 03:10:22.660\t0\n1\t13486\t2008-08-17 02:58:18.083\t2008-08-14 13:48:02.523\t3\n1\t11034\t2008-08-14 13:48:02.523\t2008-08-14 03:17:18.153\t0\n1\t10623\t2008-08-14 03:17:18.153\t2008-08-14 03:13:56.770\t0\n1\t16532\t2008-08-19 16:51:17.103\t2008-08-17 03:00:34.317\t2\n1\t26046\t2008-08-25 13:43:41.643\t2008-08-25 00:11:43.763\t0\n1\t20047\t2008-08-21 14:18:41.640\t2008-08-19 16:51:17.103\t2\n1\t25456\t2008-08-24 23:40:09.253\t2008-08-21 14:18:41.640\t3\n1\t30034\t2008-08-27 13:08:30.010\t2008-08-25 13:43:41.643\t2\n1\t414970\t2009-01-05 23:54:56.457\t2008-12-30 08:23:06.693\t6\n1\t481897\t2009-01-27 00:11:03.640\t2009-01-08 13:31:06.323\t19\n1\t499907\t2009-02-01 00:39:33.747\t2009-01-27 00:11:03.640\t5\n1\t48692\t2008-09-07 19:17:04.073\t2008-09-01 12:03:30.520\t6\n1\t62164\t2008-09-15 11:03:36.220\t2008-09-10 16:08:14.597\t5\n1\t195239\t2008-10-12 08:38:43.303\t2008-10-10 12:59:39.503\t2\n1\t606024\t2009-03-03 11:29:38.980\t2009-03-02 22:56:01.477\t1\n1\t1107891\t2009-07-10 05:44:43.990\t2009-07-07 17:24:04.750\t3\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1595515415801_1811199782","id":"20200723-144335_1045648711","dateCreated":"2020-07-23T14:43:35+0000","dateStarted":"2020-07-23T15:37:15+0000","dateFinished":"2020-07-23T15:37:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3016"},{"text":"%md\n## 3-1. Per user, show me standard deviation of post gap dates. (could be an example feature)\n","user":"jhko","dateUpdated":"2020-07-23T15:43:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>3-1. Per user, show me standard deviation of post gap dates. (could be an example feature)</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1595518351764_943708996","id":"20200723-153231_620440696","dateCreated":"2020-07-23T15:32:31+0000","dateStarted":"2020-07-23T15:43:47+0000","dateFinished":"2020-07-23T15:43:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3017"},{"text":"%sql\n\n--- using LAG()OVER() query\n\nSELECT OwnerUserId, STDDEV(COALESCE(`DATEDIFF(CreationDate, PrevCreationDate), 0)) AS GapStdev\nFROM\n    (SELECT  OwnerUserId, PostId, CreationDate, LAG(CreationDate, 1) OVER(PARTITION BY OwnerUserId ORDER BY CreationDate) AS PrevCreationDate\n    FROM Posts P\n    ORDER BY OwnerUserId ASC)\nGROUP BY OwnerUserId\nLIMIT 20","user":"jhko","dateUpdated":"2020-07-23T23:32:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"OwnerUserId":"string","GapStdev":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"OwnerUserId\tGapStdev\n1\t35.421998932135956\n100\t25.64886456343955\n1000\t30.558774492960215\n1000000\t0.0\n1000008\t137.41300278115364\n1000010\tNaN\n1000011\t8.48528137423857\n1000013\t0.7071067811865476\n1000017\t0.7071067811865476\n1000019\t0.7071067811865476\n1000021\t0.408248290463863\n1000022\tNaN\n1000024\t4.041451884327381\n1000025\tNaN\n1000026\t8.888194417315589\n1000028\t38.18376618407357\n1000030\t15.771426433201652\n1000032\tNaN\n1000034\tNaN\n1000036\tNaN\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1595517426060_1852082052","id":"20200723-151706_2013096588","dateCreated":"2020-07-23T15:17:06+0000","dateStarted":"2020-07-23T15:38:34+0000","dateFinished":"2020-07-23T15:38:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3018"},{"text":"%md\nend!\n","user":"jhko","dateUpdated":"2020-07-23T15:37:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>end!</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1595518541993_660946214","id":"20200723-153541_516299729","dateCreated":"2020-07-23T15:35:41+0000","dateStarted":"2020-07-23T15:37:02+0000","dateFinished":"2020-07-23T15:37:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3019"},{"text":"%md\n","user":"jhko","dateUpdated":"2020-07-23T15:37:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1595518622591_1520732257","id":"20200723-153702_1319311856","dateCreated":"2020-07-23T15:37:02+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3020"}],"name":"AdvancedSQL-sol","id":"2FFASP2R5","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark::2FFASP2R5":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
